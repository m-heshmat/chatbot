from langchain_community.utilities.google_search import GoogleSearchAPIWrapper

def search_results_for_vuln(query: str, max_results=1):
    search = GoogleSearchAPIWrapper()
    raw_results = search.results(query, num_results=max_results)

    formatted = []
    for result in raw_results:
        formatted.append({
            
            "link": result.get("link"),
            "snippet": result.get("snippet"),    
        })

    return formatted

def live_web_search(query: str, max_results=20):
    """
    Perform a live web search for the given query and return a list of results.
    Each result contains a 'link' and a 'snippet'.
    This function is designed for chatbot/internet-augmented response use cases.
    """
    search = GoogleSearchAPIWrapper()
    raw_results = search.results(query, num_results=max_results)

    formatted = []
    for result in raw_results:
        formatted.append({
            "link": result.get("link"),
            "snippet": result.get("snippet"),
        })
    return formatted